![image-20210314164113571](../photos/image-20210314164113571.png)

## 如何设计一个关系型数据库？

数据库的存储模块 RDBMS

存储管理：对存储的数据进行管理

缓存机制：采用局部性原理，加上淘汰替换机制，优化访存速度

SQL解析：解析SQL语句，SQL被编译后可以保存，以便下一次直接解析

存储：用块或者页来存储，因为IO一次读取一行和多行的时间差不多

![image-20210314164523510](../photos/image-20210314164523510.png)

## 索引模块

### **为什么要使用索引？**

- 能够快速查询数据

### **什么样的信息能成为索引**

- 主键、唯一键以及普通键

### **索引的数据结构**

- 生成索引，建立二叉查找树进行二分查找
- 生成索引，建立B-Tree结构进行查找
- 生成索引，建立B+-Tree结构进行查找
- 生成索引，建立Hash结构进行查找

### **B-Tree**

![image-20210314165315561](../photos/image-20210314165315561.png)

- 根节点至少包含两个孩子
- 树中每个节点最多含有m个孩子m>=2
- 除根节点和叶结点外，其他每个节点至少有ceil（m/2）个孩子
- 所有叶子节点都位于同一层
- ![image-20210314165719485](../photos/image-20210314165719485.png)



### **B+-Tree** 

![image-20210314165850593](../photos/image-20210314165850593.png)

- 非叶子节点的子树指针与关键字个数相同
- 非叶子节点的子树指针P[i]，指向关键字值[K[i],K[i+1]]的子树
- 非叶子节点仅用来索引，数据都保存在叶子节点中
- 所有叶子节点均有一个链指针指向下一个叶子节点

#### **结论**

B+Tree更适合用来做存储索引

- B+树的磁盘读写代价更低
- B+树的查询效率更加稳定
- B+树更加有利于对数据库的扫描

### Hash索引

![image-20210314170700316](../photos/image-20210314170700316.png)

#### 缺点

- 仅仅能满足 “=”， “IN”，不能使用范围查询
- 无法被用来避免数据的排序操作
- 不能利用部分索引键查询

- 不能避免表扫描
- 遇到大量Hash值相等的情况后性能并不一定会比B-Tree高

### BitMap索引神器

![image-20210314174231188](../photos/image-20210314174231188.png)

### 密集索引和稀疏索引

- 密集索引文件的每个搜索码值都对应一个索引值
- 稀疏索引文件只为索引码的某些值建立索引项

### InnoDB

![image-20210314193809905](../photos/image-20210314193809905.png)