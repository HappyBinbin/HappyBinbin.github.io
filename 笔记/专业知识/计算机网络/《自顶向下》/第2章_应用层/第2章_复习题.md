## 复习题

##### P1

是非判断题 

1. 假设用户请求由一些文本和 3 幅图像组成的 Web 页面 。对于这个页面 ，客户将发送一个请求报文并接收 4 个响应报文 。【F】
2. 两个不同的 Web 页面 （ 例如 ，www. mit. edu/research,html 及 www. mit. edu/students, html) 可以通过同一个持续连接发送。【T】
3. 在浏览器和初始服务器之间使用非持续连接的话 ，一个 TCP 报文段是可能携带两个不同的 HTTP服务请求报文的。【F】
4. 在 HTTP 响应报文中的 Date ： 首部指出了该响应中对象最后一次修改的时间。【F】
5. HTTP 响应报文决不会具有空的报文体。【F】

##### P2

SMS 、 iMessage 和 WhatsApp 都是智能手机即时通信系统。在因特网上进行一些研究后 ，为这些系统分别写一段它们所使用协议的文字 。然后撰文解释它们的差异所在 。

##### P3

考虑一个要获取给定 URL 的 Web 文档的 HTTP 客户。该 HTTP服务器的 IP 地址开始时并不知道。在这种情况下，除了 HTTP 外，还需要什么运输层和应用层协议 ？

- 应用层协议：DNS和HTTP
- 传输层协议：UDP用于DNS；TCP用于HTTP

##### P4

考虑当浏览器发送一个 HTTP GET 报文时，通过 Wireshark 俘获到下列 ASCII 字符串 （ 即这是一个HTTP GET 报文的实际内容 ）。字符 ＜cr＞ ＜lf＞是回车和换行符 （ 即下面文本中的斜体字符串  ＜cr＞ 
表示了单个回车符 ，该回车符包含在 HTTP 首部中的相应位置 ）。回答下列问题 ，指出你在下面 HTTP GET 报文中找到答案的地方

![image-20210525165526651](https://happychan.oss-cn-shenzhen.aliyuncs.com/img/image-20210525165526651.png)

a. 由浏览器请求的文档的 URL 是什么 ？

​	http://gaia.cs.umass.edu/cs453/index.html

b. 该浏览器运行的是 HTTP 的何种版本 ？

​	HTTP/1.1

c. 该浏览器请求的是一条非持续连接还是一条持续连接 ？

​	一条持续连接，Keep-Alive：300

d. 该浏览器所运行的主机的 IP 地址是什么 ？

​	从HTTP报文中是无法获悉的，需要从IP报文中获得该信息

e. 发起该报文的浏览器的类型是什么 ？ 在一个 HTTP 请求报文中 ，为什么需要浏览器类型 ？

​	Mozilla/5.0。服务器需要浏览器类型信息将同⼀对象的不同版本发送到不同类型的浏览器。

##### P5

下面文本中显示的是来自服务器的回答，以响应上述问题中 HTTP GET 报文 。回答下列问题，指出你在下面报文中找到答案的地方 

![image-20210525165927819](https://happychan.oss-cn-shenzhen.aliyuncs.com/img/image-20210525165927819.png)

a. 服务器能否成功地找到那个文档 ？ 该文档提供回答是什么时间 ？

​	可以，状态码和短语为 200 OK，日期为 Date：2008年3月07号星期二提供格林威治标准时间12点39分45秒

b. 该文档最后修改是什么时间 ？

​	Last-Modified：2005年12⽉10⽇星期六18:27:46 格林尼治时间。

c. 文档中被返回的字节有多少 ？

​	3874B

d. 文档被返回的前 5 个字节是什么 ？ 该服务器同意一条持续连接吗 ？

​	前五个字节为 <!doc。同意，KeepAlive

##### P6 

获取 HTTP/1. 1 规范 （ RFC 2616 ） 。回答下面问题 ：

a. 解释在客户和服务器之间用于指示关闭持续连接的信令机制。客户 、 服务器或两者都能发送信令通知连接关闭吗 ？

​	在  RFC 2616  的第8节中讨论了持久连接（这⼀点的真正目的问题是让你检索并阅读⼀份RFC）。RFC第8.1.2和8.1.2.1节表示客户机或服务器可以向另一个表明它是将关闭永久连接。它通过包含连接令牌来实现“关闭”在http请求/回复的连接头字段中

b. HTTP 提供了什么加密服务?

​	不提供任何加密服务

c. 一个客户能够与一个给定的服务器打开 3 条或更多条并发连接吗?

​	使用持久连接的客户端应该限制同时维护到给定服务器的连接。单用户客户端与任何服务器或代理服务器的连接不应超过2个。”

d. 如果一个服务器或一个客户检测到连接已经空闲一段时间，该服务器或客户可以关闭两者之间的传输连接。一侧开始关闭连接而另一侧通过该连接传输数据是可能的吗？请解释。

​	是，在服务器决定关闭“空闲”连接的同时，客户端可能已经开始发送新请求。从服务器的角度来看，连接是在空闲时关闭的，但从客户端的角度来看，请求正在进行中。

##### P7

假定你在浏览器中点击一条超链接获得 Web 页面 。相关联的 URL 的 IP 地址没有缓存在本地主机上,因此必须使用 DNS lookup 以获得该 IP 地址 。如果主机从 DNS 得到 IP 地址之前已经访问了 n 个 DNS服务器 ； 相继产生的 RTT 依次为 RTT1 、 … 、 RTTn“ 。进一步假定与链路相关的 Web 页面只包含一个对象 ，即由少量的 HTML 文本组成 。令 RTT0 表示本地主机和包含对象的服务器之间的 RTT 值 。假定
该对象传输时间为零 ，则从该客户点击该超链接到它接收到该对象需要多长时间 ？

- 获取IP地址的时间为 RTT1 + ... + RTTn
- 得到IP地址后，获取对象的时间为：2RTT0

则总时间为 2RTT0 + RTT1 + ... + RTTn

##### P8

参照习题 P7, 假定在同一服务器上某 HTML 文件引用了 8 个非常小的对象。忽略发送时间 ，在下列情况下需要多长时间：

a. 没有并行 TCP 连接的非持续 HTTP

​	RTT1 + ... + RTTn + 2RTT0 + 8 * 2RTT0 = 18RTT0 + RTT1 + ... + RTTn

b. 配置有 5 个并行连接的非持续 HTTP

​	因此一次可以并行发五个，所以最多两次就可以发完

​	RTT1 + ... + RTTn + 2RTT0 + 2 * 2RTT0 = 6RTT0 + RTT1 + ... + RTTn

c. 持续 HTTP

- 流水线的持久连接：
    - RTT1 + ... + RTTn + 2RTT0 + RTT0 = 3RTT0 + RTT1 + ... + RTTn
- 非流水线非并行持久连接：
    - RTT1 + ... + RTTn + 2RTT0 + 8RTT0 = 10RTT0 + RTT1 + ... + RTTn

##### P9

考虑图 2-12, 其中有一个机构的网络和因特网相连。假定对象的平均长度为 850000 比特，从这个机构网的浏览器到初始服务器的平均请求率是每秒 16 个请求。还假定从接入链路的因特网一侧的路由器转发一个 HTTP 请求开始，到接收到其响应的平均时间是 3 秒 （ 参见 2.2.5 节 ）将总的平均响应时间建模为平均接入时延 （ 即从因特网路由器到机构路由器的时延 ） 和平均因特网时延之和。对于平均接入时延 ，使用  △ /（ 1-△β ），式中△是跨越接入链路发送一个对象的平均时间，β  是对象对该接入链路的平均到达率

a. 求出总的平均响应时间

​	在链路或速率R上传输大小为L的对象的时间是 L / R，平均时间是对象的平均大小除以R：

​	δ(△)= (850000bits)/(15000000bits/sec) = 0.0567sec

​	β = 16 个请求 / s

则链路的流量强度为 δ * β = （16 个请求 / s）* （0.567秒/请求）= 0.907

​	平均接入时延 =  △ / (1-△β) = (0.567秒)/(1 − 0.907) ≈ 0.61秒

​	总的平均响应时间 = t接 + t因 = 3.61s

b. 现在假定在这个机构 LAN 中安装了一个缓存器，假定命中率为 0.4, 求出总的响应时间

因为命中率为0.4，则接入链路上的业务强度降低为60%，那么 β = 16个请求/s * 60%

则平均接入时延 = △ / (1-△β) = 0.12s

当缓存命中时，平均命中响应时间为 = 850000b / 100Mbps = 0.0085s

总响应时间 = 0.4 * 0.0085 + 0.6(0.12 + 3) = 1.8754s

<img src="https://happychan.oss-cn-shenzhen.aliyuncs.com/img/image-20210525193438543.png" alt="image-20210525193438543" style="zoom: 50%;" />

##### P10

考虑一条 10 米短链路 ，某发送方经过它能够以 150bps 速率双向传输 。假定包含数据的分组是100 000 比特长 ，仅包含控制 （ 如 ACK 或握手 ） 的分组是 200 比特长 。假定 N 个并行连接每个都获得 1/W 的链路带宽 。现在考虑 HTTP 协议 ，并且假定每个下载对象是 100Kb 长 ，这些初始下载对象包含 10 个来自相同发送方的引用对象 。在这种情况下 ，经非持续 HTTP 的并行实例的并行下载有意义吗 ？ 现在考虑持续 HTTP 。你期待这比非持续的情况有很大增益吗 ？ 评价并解释你的答案 

让 Tp 表示客户端和服务器之间的单向传输时延

**非持续连接：**

建立TCP连接：

​	((200b / 150bps) + Tp) * 3

传输初始对象：

​	100000 / 150 + Tp

并行传输引用对象：

​	((200b / (150 / 10) bps) + Tp) * 3 + (100000 / (150 / 10) + Tp)

总时间为：7377s

**持续连接：**

(200b / 150bps + Tp) * 3 + ((10^5)b / 150bps + Tp) + 10 * (200b/150bps + (10^5)b/150bps + 2Tp) = 

总时间为：7351s

因为10米短链路，忽略其传播时延，所以，持久性HTTP的速度并不显著比（小于1%）并行下载的非持久性案例快。

##### P11

考虑在前一个习题中引出的情况 。现在假定该链路由 Bob 和 4 个其他用户所共享 。Bob 使用非持续HTTP 的并行实例 ，而其他 4 个用户使用无并行下载的非持续 HTTP 。

a. Bob 的并行连接能够帮助他更快地得到 Web 页面吗 ？

​	是的，有更多的连接，就能获得更大的链路带宽份额

b. 如果所有 5 个用户打开 5 个非持续 HTTP 并行实例 ，那么 Bob 的并行连接仍将是有好处的吗 ？ 为什么?

​	是的，仍要要执行并行下载

##### P12

##### P13

SMTP 中的 MAIL FROM 与该邮件报文自身中的 From ： 之间有什么不同？

MAIL FROM 是 SMTP 握手协议的一部分，而 From 是邮件报文的一部分。

##### P14

SMTP 是怎样标识一个报文体结束的 ？ HTTP 是怎样做的呢 ？ HTTP 能够使用与 SMTP 标识一个报文体结束相同的方法吗 ？ 试解释 

SMTP 使用仅包含一个句号的一行来标志报文体结束，HTTP 使用 Content-Length 标志。

不，HTTP不能使用SMTP使用的方法，因为HTTP消息可以是二进制数据，而在SMTP中，消息主体必须是7位的ASCII格式。

##### P15

阅读用于 SMTP 的 RFC 5321 o MTA 代表什么 ？ 考虑下面收到的垃圾邮件 （ 从一份真实垃圾邮件修改得到 ） 。假定这封垃圾邮件的唯一始作俑者是恶意的 ，而其他主机是诚实的 ，指出产生了这封垃圾邮件的恶意主机

<img src="https://happychan.oss-cn-shenzhen.aliyuncs.com/img/image-20210529171230686.png" alt="image-20210529171230686" style="zoom:50%;" />

MTA(Mail Transfer Agents) 其实就是提供邮件传输服务的 SMTP 服务器和客户端。

Received 是 在将消息转发到 Internet 环境或从 Internet 环境转发消息时，网关必须预先添加 Received 行，并且它不得以任何方式更改已在标题部分中的 Received 行。因此排在最后面的 Received 行所指示的地址就是源地址，即 58.88.21.177

##### P16

##### P17

##### P18

如题 ：

a. 什么是 whois 数据库 ？

​	whois（读作“Who is”，非缩写）是用来查询域名的IP以及所有者等信息的传输协议。简单说，whois就是一个用来查询域名是否已经被注册，以及注册域名的详细信息的数据库（如域名所有人、域名注册商）。通过whois来实现对域名信息的查询。早期的whois查询多以命令列接口存在，但是现在出现了一些网页接口简化的线上查询工具，可以一次向不同的数据库查询。网页接口的查询工具仍然依赖whois协议向服务器发送查询请求，命令列接口的工具仍然被系统管理员广泛使用。whois通常使用TCP协议43端口。每个域名/IP的whois信息由对应的管理机构保存。

b. 使用因特网上的各种 whois 数据库 ，获得两台 DNS 服务器的名字 ，指出你使用的是哪个 whois 数据 库 。

c. 你本地机器上使用 nslookup 向 3 台 DNS 服务器发送 DNS 査询 ： 你的本地 DNS 服务器和两台你在（ b ） 中发现的 DNS 服务器 。尝试对类型 A 、 NS 和 MX 报告进行查询 。总结你的发现 。

d. 使用 nslookup 找出一台具有多个 IP 地址的 Web 服务器 。你所在的机构 （ 学校或公司 ） 的 Web 服务器具有多个 IP 地址吗 ？

e. 使用 ARIN whois 数据库 ，确定你所在大学使用的 IP 地址范围 。

f. 描述一个攻击者在发动攻击前 ，能够怎样利用 whois 数据库和 nslookup IM 来执行对一个机构的侦察 。

g. 讨论为什么 whois 数据库应当为公众所用 

##### P19

##### P20

假定你能够访问所在系的本地 DNS 服务器中的缓存 。 你能够提出一种方法来粗略地确定在你所在系的用户中最为流行的 Web 服务器 （ 你所在系以外 ）吗 ？ 解释原因 

​	我们可以定期拍摄本地DNS服务器中DNS缓存的快照。该组织在DNS缓存中出现最频繁的Web服务器是最流行的服务器。这是因为如果更多的用户对Web服务器感兴趣，那么DNS请求就会对此感兴趣服务器更频繁地由用户发送。因此，该Web服务器将出现在DNS中缓存更频繁。

##### P21

假设你所在系具有一台用于系里所有计算机的本地 DNS 服务器 。 你是普通用户 （ 即你不是网络 / 系统管理员 ） 。 你能够确定是否在几秒前从你系里的一台计算机可能访问过一台外部 Web 站点吗 ？

​	很简单，只需要输入这样的命令`dig server`，把 server 改成你想测试的网站名，如果 Query time 极短，说明最近可能有人访问过该网站。

##### P22

考虑向 N 个对等方分发 F = 15Gb 的一个文件 。 该服务器具有 = 30Mbps 的上载速率 ， 每个对等方具有 di = 2Mbps 的下载速率和上载速率％ 对于 N = 10. 100 和 1000 并且 “ u = 300kbps 、 700kbps 和 2Mbps, 对于 N 和 u 的每种组合绘制岀确定最小分发时间的图表 。 需要分别针对客户-服务器分发和 P2P 分发两种情况制作 

<img src="https://happychan.oss-cn-shenzhen.aliyuncs.com/img/image-20210529174241481.png" alt="image-20210529174241481" style="zoom:50%;" />

**C-S**

![image-20210529174634243](https://happychan.oss-cn-shenzhen.aliyuncs.com/img/image-20210529174634243.png)
**P2P**

![image-20210529174644253](https://happychan.oss-cn-shenzhen.aliyuncs.com/img/image-20210529174644253.png)



















































